var entranceStyleConfigVO_buttonColor = '#079ed8';
var entranceStyleConfigVO_buttonText = '复小信';
var entranceStyleConfigVO_picUrl = 'https://irobot.fudan.edu.cn/upload/material/143/20210601/3999591A74014AD09BFF96D8D98F538F.png';
var entranceStyleConfigVO_style = 1;
var entranceStyleConfigVO_textColor = '#ffffff';
var entranceStyleConfigVO_type = 2;
var entrancePositionConfigVO_position = 3;
var entrancePositionConfigVO_longitudinal = 0;
var entrancePositionConfigVO_transverse = 10;
var windowStyleConfigVO_type = 1;
var chat_window_url = 'https://irobot.fudan.edu.cn/webchatbot/chat.html?sysNum=1617934087685&sourceId=70161';
var yw_div = document.createElement('div');var yw_chat_window = null;var yw_mask = null;var yw_isDown = false;document.body.appendChild(yw_div);var w_inner_w = window.innerWidth;var w_inner_h = window.innerHeight;var entrancePositionArray = ['', 'left:' + entrancePositionConfigVO_transverse + 'px; top:' + entrancePositionConfigVO_longitudinal + 'px;', 'right:' + entrancePositionConfigVO_transverse + 'px; top:' + entrancePositionConfigVO_longitudinal + 'px;', 'left:' + entrancePositionConfigVO_transverse + 'px; top:' + (w_inner_h / 2 + entrancePositionConfigVO_longitudinal) + 'px;', 'right:' + entrancePositionConfigVO_transverse + 'px; top:' + (w_inner_h / 2 + entrancePositionConfigVO_longitudinal) + 'px;', 'left:' + entrancePositionConfigVO_transverse + 'px; bottom:' + entrancePositionConfigVO_longitudinal + 'px;', 'right:' + entrancePositionConfigVO_transverse + 'px; bottom:' + entrancePositionConfigVO_longitudinal + 'px;'];var textLength = entranceStyleConfigVO_buttonText.length * 20;var entranceStyleTypeArray = ['', {    outerStyle: 'width:35px;background:' + entranceStyleConfigVO_buttonColor + ';',    imgStyle: 'width:35px;',    textStyle: 'width: 13px;padding: 10px;word-break: break-all;text-align: center;display: inline-block;font-size: 14px;color:' + entranceStyleConfigVO_textColor + ';'},    {        outerStyle: 'height: 35px;line-height: 35px;background:' + entranceStyleConfigVO_buttonColor + ';',        imgStyle: 'height: 30px;vertical-align: middle;',        textStyle: 'padding-right:5px;color:' + entranceStyleConfigVO_textColor + ';'    },    {        outerStyle: 'width:' + textLength + 'px;height:' + textLength + 'px;line-height:' + textLength + 'px;text-align:center;border-radius:50%;background:' + entranceStyleConfigVO_buttonColor + ';',        imgStyle: 'display:none;',        textStyle: 'color:' + entranceStyleConfigVO_textColor + ';'    },    {        outerStyle: '',        imgStyle: 'display:none;',        textStyle: 'color:' + entranceStyleConfigVO_textColor + ';'    }];var yw_html = '';if (entranceStyleConfigVO_type == 1) {    yw_html = "<div style='position:fixed; width:50px; height:50px; z-index:99999;" + entrancePositionArray[entrancePositionConfigVO_position] + "visibility:visible; border: 0px;' class='iyunwen_js_class'>" + "<a id='yw_link' href='javascript:;' target='blank'><img id='yw_icon' style='border:none;' width='100%'/></a></div>";} else {    yw_html = "<div style='position:fixed; z-index:99999;" + entranceStyleTypeArray[entranceStyleConfigVO_style].outerStyle + entrancePositionArray[entrancePositionConfigVO_position] + "' class='iyunwen_js_class'>" + "<a id='yw_link' href='javascript:;' style='text-decoration: none;' target='blank'><img id='yw_icon' style='" + entranceStyleTypeArray[entranceStyleConfigVO_style].imgStyle + "'/><span id='yw_text' style='" + entranceStyleTypeArray[entranceStyleConfigVO_style].textStyle + "'></span></a></div>";}yw_div.outerHTML = yw_html;var yw_icon = document.getElementById('yw_icon');yw_icon.src = entranceStyleConfigVO_picUrl;var yw_text = document.getElementById('yw_text');if (yw_text) {    yw_text.innerText = entranceStyleConfigVO_buttonText;}var yw_link = document.getElementById('yw_link');function createChatwindowCommon (width, height) {    yw_chat_window = document.getElementById('yw_chat_window');    if (yw_chat_window) {        if (yw_mask.style.display === 'block') {            yw_mask.style.display = 'none';        } else {            yw_mask.style.display = 'block';        }    } else {        yw_mask = document.createElement('div');        document.body.appendChild(yw_mask);        yw_mask.outerHTML = '<div id="yw_chat_mask" style="position: fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.3);z-index:1000;"></div>';        yw_mask = document.getElementById('yw_chat_mask');        yw_chat_window = document.createElement('div');        var windowHtml = "<div id='yw_chat_window' style='overflow: hidden;display:block;position:absolute;width:" + width + "px;height:" + height + "px;z-index:1001;top:0;left:0;right:0;bottom:0;margin:auto;box-shadow:0 0 10px #aaa;'></div>";        var banner = document.createElement('div');        var bannerHtml = '<div id="yw_chat_banner" style="z-index: 100;position:absolute;top:0;left:0;height:20px;width:100%;background: #cacaca;">' + '<span id="yw_chat_close" style="position:absolute;top:0;right:0;height:20px;line-height:20px;width:25px;font-size:12px;color:#000;text-align: center;cursor: pointer;background:#eee;">x<span>' + '<div>';        var iframe = document.createElement('iframe');        var iframeHtml = "<iframe style='width:100%;height:680px;position:absolute;bottom:0;left:0;border:none;' src='" + chat_window_url + "'></iframe>";        yw_mask.appendChild(yw_chat_window);        yw_chat_window.outerHTML = windowHtml;        yw_chat_window = document.getElementById('yw_chat_window');        yw_chat_window.appendChild(banner);        banner.outerHTML = bannerHtml;        yw_chat_window.appendChild(iframe);        iframe.outerHTML = iframeHtml;        var yw_chat_close = document.getElementById('yw_chat_close');        yw_chat_close.addEventListener('click',            function () {                yw_mask.style.display = 'none';            });    }};function createChatwindow3 (width, height) {    yw_chat_window = document.getElementById('yw_chat_window');    var dec = '';    var dis = 0;    if (entrancePositionConfigVO_position === 1 || entrancePositionConfigVO_position === 3 || entrancePositionConfigVO_position === 5) {        dec = 'left';        dis = entrancePositionConfigVO_transverse + 50;    } else {        dec = 'right';        dis = entrancePositionConfigVO_transverse + 50;    }    if (yw_chat_window) {        if (yw_chat_window.style.width === (width + 'px')) {            yw_chat_window.style.width = '0';        } else {            yw_chat_window.style.width = width + 'px';        }    } else {        yw_chat_window = document.createElement('div');        var windowHtml = "<div id='yw_chat_window' style='overflow:hidden;" + dec + ':' + dis + "px;transition:width 0.3s;display:block;position:fixed;width:0;height:" + height + "px;top:" + ((w_inner_h - height) / 2) + "px;z-index:1000;box-shadow:0 0 10px #aaa;'></div>";        var banner = document.createElement('div');        var bannerHtml = '<div id="yw_chat_banner" style="position:absolute;top:0;left:0;height:20px;width:100%;background: #cacaca;">' + '<span id="yw_chat_close" style="position:absolute;top:0;right:0;height:20px;line-height:20px;width:25px;font-size:12px;color:#000;text-align: center;cursor: pointer;background:#eee;">x<span>' + '<div>';        var iframe = document.createElement('iframe');        var iframeHtml = "<iframe style='width:100%;height:" + (height - 20) + "px;position:absolute;bottom:0;left:0;border:none;' src='" + chat_window_url + "'></iframe>";        document.body.appendChild(yw_chat_window);        yw_chat_window.outerHTML = windowHtml;        yw_chat_window = document.getElementById('yw_chat_window');        yw_chat_window.appendChild(banner);        banner.outerHTML = bannerHtml;        yw_chat_window.appendChild(iframe);        iframe.outerHTML = iframeHtml;        var yw_chat_close = document.getElementById('yw_chat_close');        yw_chat_close.addEventListener('click',            function () {                yw_chat_window.style.width = '0';            });        setTimeout(function () {                yw_chat_window.style.width = width + 'px';            },            20);        addMoveEvent();    }};function addMoveEvent () {    var banner = document.getElementById('yw_chat_banner');    var x = 0;    var y = 0;    var l = 0;    var t = 0;    banner.addEventListener('mousedown',        function (e) {            x = e.clientX;            y = e.clientY;            l = yw_chat_window.offsetLeft;            t = yw_chat_window.offsetTop;            yw_isDown = true;            banner.style.cursor = 'move';        });    banner.addEventListener('mouseleave', release);    window.addEventListener('mousemove',        function (e) {            if (yw_isDown === false) {                return;            }            var nx = e.clientX;            var ny = e.clientY;            var nl = nx - (x - l);            var nt = ny - (y - t);            nl = Math.min(Math.max(0, nl), w_inner_w - yw_chat_window.offsetWidth);            nt = Math.min(Math.max(0, nt), w_inner_h - yw_chat_window.offsetHeight);            yw_chat_window.style.left = nl + 'px';            yw_chat_window.style.top = nt + 'px';        });    function release () {        yw_isDown = false;        banner.style.cursor = 'default';        if (yw_chat_window.style.right) {            yw_chat_window.style.right = w_inner_w - parseInt(yw_chat_window.style.left) - yw_chat_window.offsetWidth + 'px';            yw_chat_window.style.left = 'inherit';        }    };    window.addEventListener('mouseup', release);};switch (windowStyleConfigVO_type) {    case 1:    case 2:        yw_link.href = chat_window_url;        break;    case 3:        yw_link.addEventListener('click',            function (e) {                e.preventDefault();                createChatwindow3(400, 680);            });        break;    case 4:        yw_link.addEventListener('click',            function (e) {                e.preventDefault();                createChatwindowCommon(850, 700);            });        break;    default:        break;}window.closeYWChatWindow = function () {    if (windowStyleConfigVO_type === 5) {        yw_chat_window.style.right = '-400px';        setTimeout(function () {                document.body.removeChild(document.getElementById('yw_chat_window'));            },            300);    } else {        document.body.removeChild(document.getElementById('yw_chat_window'));    }}
